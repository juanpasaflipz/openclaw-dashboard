# Phase 5 — Minimal UI

Two new tabs in the Workbench group: **Tasks** and **Team**.

---

## Navigation

Both tabs are added to the Workbench dropdown in the top nav:

```
Workbench ▾
  ...
  Governance
  Tasks        ← NEW
  Team         ← NEW
```

Tab IDs: `collab-tasks`, `collab-team` (in `TAB_GROUP_MAP` under `'workbench'`).

---

## Tasks Tab (`collab-tasks`)

### Features

1. **Status filter** — dropdown for queued/running/blocked/completed/failed/canceled
2. **Agent filter** — dropdown populated from `/api/agents`
3. **Status stats** — color-coded counters for each status
4. **Task list** — cards showing title, status badge, assigned agent, priority, time
5. **Task detail modal** — click a task to see full details:
   - Status, priority, assigned agent, created date
   - Input/output JSON (if present)
   - Action buttons (Start, Complete, Fail, Cancel based on current status)
   - Full event trail with timestamps
6. **Create task modal** — title, agent assignment, priority

### API calls

| Action | Endpoint |
|--------|----------|
| List tasks | `GET /api/tasks?status=&assigned_to=` |
| Get task detail | `GET /api/tasks/<id>` |
| Start task | `POST /api/tasks/<id>/start` |
| Complete task | `POST /api/tasks/<id>/complete` |
| Fail task | `POST /api/tasks/<id>/fail` |
| Cancel task | `POST /api/tasks/<id>/cancel` |
| Create task | `POST /api/tasks` |

### JS functions

| Function | Purpose |
|----------|---------|
| `initCollabTasksTab()` | Populate filters + load tasks |
| `loadCollabTasks()` | Fetch + render task list |
| `renderCollabTaskStats()` | Status counter cards |
| `renderCollabTasksList()` | Task card list |
| `showTaskDetail(id)` | Fetch + show detail modal |
| `collabTaskAction(id, action)` | Execute task transition |
| `showCreateTaskModal()` | Create task form modal |
| `submitCreateTask()` | POST new task |

---

## Team Tab (`collab-team`)

### Features

1. **Team rules card** — toggle checkboxes for:
   - Require supervisor for agent-created tasks
   - Allow peer-to-peer assignment
   - Default supervisor dropdown (only shows agents with supervisor role)
2. **Assign role controls** — agent dropdown + role select + assign button
3. **Team summary** — grouped lists:
   - Supervisors with capabilities and remove button
   - Workers with capabilities and remove button
   - Specialists with capabilities and remove button
   - Unassigned agents

### API calls

| Action | Endpoint |
|--------|----------|
| Get rules | `GET /api/team/rules` |
| Save rules | `POST /api/team/rules` |
| List roles | `GET /api/team/roles` |
| Assign role | `POST /api/team/roles` |
| Remove role | `POST /api/team/roles/<id>/delete` |
| Team summary | `GET /api/team/summary` |

### JS functions

| Function | Purpose |
|----------|---------|
| `initCollabTeamTab()` | Load rules + summary + agent selects |
| `loadTeamRules()` | Fetch + populate rule checkboxes |
| `saveTeamRules()` | POST rule changes (auto-save on change) |
| `populateTeamAgentSelects()` | Fill agent + supervisor dropdowns |
| `assignAgentRole()` | POST role assignment |
| `removeAgentRole(id)` | DELETE role + refresh |
| `loadTeamSummary()` | Fetch + render grouped role lists |

---

## Files modified

| File | Changes |
|------|---------|
| `dashboard.html` | Nav items + 2 tab-content divs (~120 lines) |
| `static/js/dashboard-main.js` | TAB_GROUP_MAP + switchTab + ~400 lines of JS |

---

## Design notes

- Follows existing vanilla JS + template literal patterns
- No new CSS classes — reuses `.card`, `.btn`, `.btn-primary`, `.btn-secondary`
- Auto-save on team rules (checkbox `onchange`)
- Task detail modal with inline action buttons
- Agent names shown where available, fallback to "Agent #id"
- `escapeHtml()` helper for safe rendering of user content
